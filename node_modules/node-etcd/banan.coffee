util = require 'util'
e = new (require './src') ['localhost:4001', 'localhost:4002', 'localhost:4003']

setrand = () ->
  e.set 'a', Math.random(), (err, val) ->
    if err
      console.log util.inspect err.errors, {depth: 5}
      throw err
    else
      console.log val

#setInterval setrand, 20


logError = (e) ->
  if e
    console.log e?.errors

w = e.watcher 'a'
w.on 'change', console.log
w.on 'resync', console.log

setInterval (() ->
  e.set 'a', new Date(), logError
), 15000

setInterval (() ->
  e.set 'b', Math.random(), logError
), 5

setInterval (() ->
  e.set 'c', Math.random(), logError
), 5
